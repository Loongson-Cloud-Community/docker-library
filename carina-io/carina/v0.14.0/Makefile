# This file is generated by the template.

REGISTRY	?=lcr.loongnix.cn
ORGANIZATION	?=carina-io
REPOSITORY	?=carina
TAG		?=v0.14.0
LATEST		?=true

IMAGE=$(REGISTRY)/$(ORGANIZATION)/$(REPOSITORY):$(TAG)
LATEST_IMAGE=$(REGISTRY)/$(ORGANIZATION)/$(REPOSITORY):latest

default: image

image:
	@git clone https://github.com/carina-io/carina.git; cd carina; git checkout remotes/origin/feature/v0.14.0 -b v0.14.0; cd -
	@cd carina; patch -p1 < ../0001-fix-build-error-on-loongarch64.patch; cd -
	@cd carina; make docker-build; cd -
	@cd carina/scheduler; make docker-build; cd -
	@rm -rf carina
push:
	docker push lcr.loongnix.cn/carina/carina-scheduler:v0.14.0
	docker push lcr.loongnix.cn/carina/carina:v0.14.0

